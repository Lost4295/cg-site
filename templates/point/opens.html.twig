{% extends 'base.html.twig' %}
{% block title %} Voir les points OPEN d'un élève {% endblock %}



{% block body %}
    <link
        href="https://unpkg.com/gridjs/dist/theme/mermaid.min.css"
        rel="stylesheet"
    />
    <div class="container-fluid my-5">
        <h2>
            Liste des points OPEN des élèves
        </h2>
        <p class="text-muted"> Pour avoir le détail des points pour le semestre d'un élève, cliquez sur son nom.</p>
        <p class="text-muted"> <span class="text-danger fw-bold">Attention !</span> Les points des élèves avec l'émoji ⚠️ ne sont potentiellement pas à jour (ils sont gérés autrement, en fonction de l'investissement de l'administrateur dans l'association). Veuillez demander au président ses points afin de vous en assurer.</p>

        <div id="wrapper"></div>

    </div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="https://unpkg.com/gridjs/dist/gridjs.umd.js"></script>
{% endblock %}

{% block additionnal_javascripts %}
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const grid = new gridjs.Grid({
                pagination: true,
                sort: true,
                search: {
                    server: {
                        url: (prev, keyword) => `${prev}?search=${keyword}`
                    }
                },
                columns: ['Élève', 'Rendu 1', 'Rendu 2'],
                server: {
                    url: `${window.location.origin}/get/NJXWQYLONZQWM2LMNFXWY`,
                    then: data => data.map(eleve => [gridjs.html(`<a href="${window.location.origin}/NJXWQYLONZQWM2LMNFXWY/${eleve.id}">${eleve.name} (${eleve.classe}) ${eleve.warning}</a>`), Math.round(eleve.r1*100)/100, Math.round(eleve.r2*100)/100 ])
                }
            }).render(document.getElementById("wrapper"));
            console.log(grid);
            console.log("rendered grid");
        })
    </script>
{% endblock %}
